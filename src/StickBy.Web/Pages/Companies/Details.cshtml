@page "{id:guid}"
@model StickBy.Web.Pages.Companies.DetailsModel
@inject ILocalizationService L
@{
    ViewData["Title"] = Model.Company?.Name ?? L["companies.title"];
}

<div class="page-header">
    <h1 class="page-title">@Model.Company?.Name</h1>
    <a href="~/Companies" class="btn-secondary">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="19" y1="12" x2="5" y2="12"/>
            <polyline points="12 19 5 12 12 5"/>
        </svg>
        @L["common.back"]
    </a>
</div>

@if (Model.Company != null)
{
    <div class="company-header-card">
        @if (!string.IsNullOrEmpty(Model.Company.BackgroundImageUrl))
        {
            <div class="company-cover" style="background-image: url('@Model.Company.BackgroundImageUrl')"></div>
        }
        else
        {
            <div class="company-cover company-cover-default"></div>
        }
        <div class="company-profile">
            <div class="company-logo-large">
                @if (!string.IsNullOrEmpty(Model.Company.LogoUrl))
                {
                    <img src="@Model.Company.LogoUrl" alt="@Model.Company.Name" />
                }
                else
                {
                    <span>@GetInitials(Model.Company.Name)</span>
                }
            </div>
            <div class="company-details">
                <h2 class="company-name">@Model.Company.Name</h2>
                @if (Model.Company.IsContractor)
                {
                    <span class="contractor-badge">@L["companies.contractor"]</span>
                }
                <div class="company-stats">
                    <span class="stat-item">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                        </svg>
                        @Model.Company.FollowerCount @L["companies.followers"]
                    </span>
                    <span class="stat-item">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                            <line x1="16" y1="2" x2="16" y2="6"/>
                            <line x1="8" y1="2" x2="8" y2="6"/>
                            <line x1="3" y1="10" x2="21" y2="10"/>
                        </svg>
                        @L["companies.since"] @Model.Company.CreatedAt.Year
                    </span>
                </div>
            </div>
        </div>
    </div>

    @if (!string.IsNullOrEmpty(Model.Company.Description))
    {
        <div class="company-section">
            <h3>@L["companies.about"]</h3>
            <p class="company-description">@Model.Company.Description</p>
        </div>
    }

    <div class="company-section">
        <h3>@L["companies.type"]</h3>
        <div class="company-type-info">
            @if (Model.Company.IsContractor)
            {
                <div class="type-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
                    </svg>
                    <div>
                        <strong>@L["companies.contractor"]</strong>
                        <p>@L["companies.contractorDescription"]</p>
                    </div>
                </div>
            }
            else
            {
                <div class="type-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
                        <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
                    </svg>
                    <div>
                        <strong>@L["companies.company"]</strong>
                        <p>@L["companies.companyDescription"]</p>
                    </div>
                </div>
            }
        </div>
    </div>
}

@functions {
    private string GetInitials(string name)
    {
        if (string.IsNullOrEmpty(name)) return "?";
        var parts = name.Split(' ', StringSplitOptions.RemoveEmptyEntries);
        if (parts.Length >= 2)
            return $"{parts[0][0]}{parts[1][0]}".ToUpper();
        return name.Length >= 2 ? name[..2].ToUpper() : name[0].ToString().ToUpper();
    }
}

<style>
    .company-header-card {
        background: var(--surface);
        border-radius: 0.75rem;
        overflow: hidden;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        margin-bottom: 1.5rem;
    }
    .company-cover {
        height: 140px;
        background-size: cover;
        background-position: center;
    }
    .company-cover-default {
        background: linear-gradient(135deg, #1e3a8a, #3b82f6);
    }
    .company-profile {
        display: flex;
        align-items: flex-start;
        gap: 1.25rem;
        padding: 1.25rem;
        margin-top: -40px;
    }
    .company-logo-large {
        width: 80px;
        height: 80px;
        border-radius: 0.75rem;
        background: var(--surface);
        border: 3px solid var(--surface);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: 700;
        color: white;
        background: var(--primary-color);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }
    .company-logo-large img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 0.5rem;
    }
    .company-details {
        flex: 1;
        padding-top: 44px;
    }
    .company-name {
        margin: 0 0 0.5rem;
        font-size: 1.25rem;
    }
    .contractor-badge {
        display: inline-block;
        font-size: 0.6875rem;
        font-weight: 600;
        padding: 0.25rem 0.5rem;
        background: rgba(59, 130, 246, 0.15);
        color: #2563eb;
        border-radius: 4px;
        text-transform: uppercase;
        margin-bottom: 0.75rem;
    }
    .company-stats {
        display: flex;
        gap: 1.5rem;
    }
    .stat-item {
        display: flex;
        align-items: center;
        gap: 0.375rem;
        font-size: 0.875rem;
        color: var(--text-muted);
    }
    .company-section {
        background: var(--surface);
        border-radius: 0.75rem;
        padding: 1.25rem;
        margin-bottom: 1rem;
    }
    .company-section h3 {
        margin: 0 0 1rem;
        font-size: 1rem;
    }
    .company-description {
        margin: 0;
        color: var(--text-secondary);
        line-height: 1.6;
    }
    .company-type-info {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }
    .type-item {
        display: flex;
        gap: 1rem;
        padding: 1rem;
        background: var(--background);
        border-radius: 0.5rem;
    }
    .type-item svg {
        flex-shrink: 0;
        color: var(--primary-color);
    }
    .type-item strong {
        display: block;
        margin-bottom: 0.25rem;
    }
    .type-item p {
        margin: 0;
        font-size: 0.875rem;
        color: var(--text-muted);
    }
</style>
